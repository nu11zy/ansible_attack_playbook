# - name: Install alacritty
#   become: true
#   copy:
#     src: "{{ playbook_dir }}/roles/alacritty/files/alacritty"
#     dest: /usr/local/bin/alacritty
#     mode: 0755

- name: "Download rust installer"
  get_url:
    url: https://sh.rustup.rs
    dest: /tmp/sh.rustup.rs
    mode: '0755'
    force: 'yes'

- name: "install rust/cargo"
  shell: /tmp/sh.rustup.rs -y

- name: "install alacritty dependencies"
  become: true
  ansible.builtin.apt:
    name:
      - cmake
      - pkg-config
      - libfreetype6-dev
      - libfontconfig1-dev
      - libxcb-xfixes0-dev
      - libxkbcommon-dev
      - python3

- name: "Download alacritty"
  ansible.builtin.git:
    repo: "https://github.com/alacritty/alacritty"
    dest: "/tmp/alacritty"

- name: "Build alacritty"
  ansible.builtin.shell: |
    cd /tmp/alacritty
    cargo build --release

- name: "Copy binary to /usr/local/bin"
  become: true
  copy:
    src: "/tmp/alacritty/target/release/alacritty"
    dest: "/usr/local/bin/alacritty"
    mode: 0755